'use strict'; var UA = navigator.appVersion; var uc = UA.split('UCBrowser/').length > 1 ? 1 : 0; var qq = UA.split('MQQBrowser/').length > 1 ? 2 : 0; var wx = /micromessenger/i.test(UA); var qqVs = qq ? parseFloat(UA.split('MQQBrowser/')[1]) : 0; var ucVs = uc ? parseFloat(UA.split('UCBrowser/')[1]) : 0; var os = (function () { var ua = navigator.userAgent; if (/iphone|ipod/i.test(ua)) { return 1; } else if (/Android/i.test(ua)) { return 2; } else { return 0; } }()); var qqBridgeLoaded = false; // 进一步细化版本和平台判断if ((qq && qqVs < 5.4 && os == 1) || (qq && qqVs < 5.3 && os == 1)) {    qq = 0;} else {    if (qq && qqVs < 5.4 && os == 2) {        qq = 1;    } else {        if (uc && ((ucVs < 10.2 && os == 1) || (ucVs < 9.7 && os == 2))) {            uc = 0;        }    }}function loadqqapi(cb) {    // qq == 0     if (!qq) {        return cb && cb();    }    var script = document.createElement('script');    script.src = (+qq === 1) ? '//3gimg.qq.com/html5/js/qb.js' : '//jsapi.qq.com/get?api=app.share';        script.onload = function () {        cb && cb();    };    document.body.appendChild(script);}function ucShare(config) {    // ['title', 'content', 'url', 'platfORM', 'disablePlatform', 'source', 'htmlID']    // 关于platform    // iOS: kWeixin || kWeixinFriend;    // android: WechatFriends || WechatTimeline    // uc 分享会直接使用截图    var platform = '';    var shareInfo = null;    // 指定了分享类型    if (config.type) {        if (os == 2) {            platform = config.type == 1 ? 'WechatTimeline' : 'WechatFriends';        } else if (os == 1) {            platform = config.type == 1 ? 'kWeixinFriend' : 'kWeixin';        }    }    shareInfo = [config.title, config.desc, config.url, platform, '', '', ''];    // android     if (window.ucWEB) {        ucweb.startRequest && ucweb.startRequest('shell.page_share', shareInfo);        return;    }    if (window.ucbrowser) {        ucbrowser.web_share && ucbrowser.web_share.apply(null, shareInfo);        return;    }}function qqShare(config) {    var type = config.type;    //微信好友 1, 微信朋友圈 8    type = type ? ((type == 1) ? 8 : 1) : '';    var share = function () {        var shareInfo = {            'url': config.url,            'title': config.title,            'description': config.desc,            'img_url': config.img,            'img_title': config.title,            'to_app': type,            'cus_txt': ''        };        if (window.browser) {            browser.app && browser.app.share(shareInfo);        } else if (window.qb) {            qb.share && qb.share(shareInfo);        }    };    if (qqBridgeLoaded) {        share();    } else {        loadqqApi(share);    }}function mShare(config) {    this.config = config;    this.init = function (type) {        if (typeof type != 'undefined') this.config.type = type;        try {            if (uc) {                ucShare(this.config);            } else if (qq && !wx) {                qqShare(this.config);            }        } catch (e) {}    }}// 预加载 qq bridgeloadqqApi(function () {    qqBridgeLoaded = true;});if (typeof module === 'object' && module.exports) {    module.exports = mShare;} else {    window.mShare = mShare;}